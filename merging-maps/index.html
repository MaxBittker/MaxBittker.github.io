<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.65 'Arvo',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Arvo',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:2.25rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.62671rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.38316rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.85028rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.78405rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}ul{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.65rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:1rem;line-height:1.65rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}blockquote{margin-left:1.65rem;margin-right:1.65rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.65rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.65rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}li > ul{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.65rem / 2);}code{font-size:0.85rem;line-height:1.65rem;}kbd{font-size:0.85rem;line-height:1.65rem;}samp{font-size:0.85rem;line-height:1.65rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.1rem;padding-right:1.1rem;padding-top:0.825rem;padding-bottom:calc(0.825rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:none;}</style><style data-href="/styles.4aacbcf098c9fd0389f0.css" id="gatsby-global-css">input[type=range][orient=vertical]{-ms-writing-mode:bt-lr;writing-mode:bt-lr;-webkit-appearance:slider-vertical;width:8px;height:175px;padding:0 5px}input{filter:grayscale(1)}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px;text-align:center}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}#fullFrame{position:fixed;top:0;left:0;height:100vh;width:100vw;border:none;z-index:101;overflow:hidden;height:-webkit-fill-available!important;margin:0!important}html:has(#fullFrame){overflow:hidden}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.maxbittker{font-family:Astloch,sans-serif}body,html{margin:0;padding:0;max-width:100%;overflow-x:hidden;border-radius:0!important}.home{column-count:3;column-gap:0;margin:0;width:calc(100% - 1px);font-size:0}.home img{margin:0;display:block}.home p{margin-top:.25em;margin-bottom:.25em}@media screen and (min-width:900px){.home{max-height:calc(100vh - 72px)}}@media screen and (min-width:1500px){.home{column-count:4}}.home-brick{display:inline-block;width:100%;font-size:1rem;position:relative}.home-brick p{margin:.25em}.min,.x{position:absolute;z-index:500;right:-1px;top:0;padding:0;font-size:10px;display:flex;justify-content:center;align-content:center;font-family:monospace;height:13px;width:13px;line-height:0;cursor:pointer;border:1px solid #000;background-color:#f4eeef}.x svg{pointer-events:none}.x polyline{fill:none;stroke:#000;stroke-width:1px}.min{right:13px}marquee{width:100%}.loom{line-height:0;position:absolute;left:0;top:0;right:0;width:100vw;height:100vh;overflow:hidden;z-index:0;pointer-events:none;stroke:#000;stroke-width:1px}.loom-row{width:100%;display:flex;overflow:hidden}.hradio{line-height:0;margin-bottom:0;display:flex;flex-wrap:wrap;justify-content:space-evenly}.b-wrap{border:1px solid #000;padding:5px;background-color:#f4eeef;z-index:1}.b-wrap.fill{display:flex;align-items:stretch;width:100%}.header .b-wrap{display:inline-block}.pack{margin-right:-1px;margin-bottom:-1px;box-shadow:none}@media screen and (max-width:660px){.b-wrap{padding:1px;box-shadow:none}.home{column-count:2}}@media screen and (max-width:960px){.desktopOnly{display:none}}@media screen and (max-width:370px){.b-wrap{padding:1px}.home{column-count:1}}.index{height:100%;width:100%}.less-nav-example ul{margin:0;padding:0;list-style:none}.less-nav-example li{display:inline-block}.less-nav-example a{background:pink;border-radius:3px;display:block;margin-right:6px;padding:3px 9px;text-decoration:none}.the-less-class{text-decoration:underline}.headroom *{color:#382e31!important}body{background:#f4eeef}pre{border:1px solid #000;border-radius:0!important}h1{border-bottom:1px dashed #000;margin-top:.2em}#canvas{position:fixed;z-index:1}a{color:#55e;text-decoration:none}a:link{color:#58c}a:visited{color:#97c}a:hover{color:#55e}a:active{color:#00f}.markdown img{max-height:50vh;float:right;display:block;margin:10px}.red{color:#ff0;text-shadow:-1px -1px 0 #00f,1px -1px 0 #0f0,-1px 1px 0 #00f,1px 1px 0 red}.ground{width:100%;height:100%;margin:0}.plate{width:90%;height:60vh;margin:30px auto;display:flex;border:30px solid #fff}.plate .paper{height:20%;width:100%}.plate .ground-left{background-color:#fff;width:50%}.plate .ground-left .paper{background-color:#fa9}.plate .ground-left .paper:first-child{opacity:1}.plate .ground-left .paper:nth-child(2){opacity:.8}.plate .ground-left .paper:nth-child(3){opacity:.6}.plate .ground-left .paper:nth-child(4){opacity:.4}.plate .ground-left .paper:nth-child(5){opacity:.2}.plate .ground-left .paper:nth-child(6){opacity:0}.plate .ground-right{background-color:#fff;width:50%}.plate .ground-right .paper,.plate .ground-right .paper:first-child{background-color:#9af}.plate .ground-right .paper:nth-child(2){background-color:#adbbff}.plate .ground-right .paper:nth-child(3){background-color:#c2ccff}.plate .ground-right .paper:nth-child(4){background-color:#d6ddff}.plate .ground-right .paper:nth-child(5){background-color:#ebeeff}.plate .ground-right .paper:nth-child(6){background-color:#fff}.plate-two{width:90%;height:60vh;margin:30px auto;display:flex;border:30px solid #fff;overflow:hidden;position:relative}.plate-two .paper{position:absolute;width:50%}.plate-two .ground-left{background-color:#fff;width:50%}.plate-two .ground-left .paper{background-color:#5b83ad;height:100%;opacity:.2}.plate-two .ground-left .paper:first-child{height:100%}.plate-two .ground-left .paper:nth-child(2){height:80%}.plate-two .ground-left .paper:nth-child(3){height:60%}.plate-two .ground-left .paper:nth-child(4){height:40%}.plate-two .ground-left .paper:nth-child(5){height:20%}.plate-two .ground-left .paper:nth-child(6){height:0%}.plate-two .ground-right{background-color:#fff;width:50%;height:100%;right:0}.plate-two .ground-right .paper{background-color:#5b83ad}.plate-two .ground-right .paper:first-child{height:20%;z-index:100;background-color:#5b83ad}.plate-two .ground-right .paper:nth-child(2){height:40%;z-index:80;background-color:#7c9cbd}.plate-two .ground-right .paper:nth-child(3){height:60%;z-index:60;background-color:#9db5ce}.plate-two .ground-right .paper:nth-child(4){height:80%;z-index:40;background-color:#bdcdde}.plate-two .ground-right .paper:nth-child(5){background-color:#dee6ef;height:100%;z-index:20}.plate-two .ground-right .paper:nth-child(6){z-index:10;background-color:#fff}.plate-three{width:90%;height:60vh;margin:30px auto;display:flex;border:30px solid #fff;overflow:hidden;position:relative}.plate-three .paper{position:absolute;width:50%}.plate-three .ground-left{background-color:#fff;width:50%}.plate-three .ground-left .paper{height:100%}.plate-three .ground-left .paper .layer{position:absolute;width:100%;background-color:#5b83ad;height:100%;opacity:.2}.plate-three .ground-left .paper:first-child{height:100%}.plate-three .ground-left .paper:nth-child(2){height:80%}.plate-three .ground-left .paper:nth-child(3){height:60%}.plate-three .ground-left .paper:nth-child(4){height:40%}.plate-three .ground-left .paper:nth-child(5){height:20%}.plate-three .ground-left .paper:nth-child(6){height:0%}.plate-three .ground-right{background-color:#fff;width:50%;height:100%;right:0}.plate-three .ground-right .paper{background-color:#5b83ad}.plate-three .ground-right .paper:first-child{height:20%;z-index:100;background-color:#5b83ad}.plate-three .ground-right .paper:nth-child(2){height:40%;z-index:80;background-color:#7c9cbd}.plate-three .ground-right .paper:nth-child(3){height:60%;z-index:60;background-color:#9db5ce}.plate-three .ground-right .paper:nth-child(4){height:80%;z-index:40;background-color:#bdcdde}.plate-three .ground-right .paper:nth-child(5){background-color:#dee6ef;height:100%;z-index:20}.plate-three .ground-right .paper:nth-child(6){z-index:10;background-color:#fff}.art-masonry{display:grid;max-width:800px;margin:auto;grid-template-columns:repeat(1,100%)}@media screen and (max-width:600px){.art-masonry{grid-template-columns:repeat(1,100%);margin:0 -2em}}.art-card{border:2px solid #f4eaed;overflow:hidden;box-sizing:content-box;width:100%}.art-card img{margin:0;width:100%}.ipost,.ipost div{overflow:hidden}.ipost div{margin-top:-55px;margin-bottom:-35%}@media screen and (max-width:500px){.art-card{width:100%;height:95vw}}.canvas{image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;-ms-interpolation-mode:nearest-neighbor;image-rendering:pixelated}iframe.header{width:100%;height:300px;max-height:50vw;border:1px solid #000}blockquote{padding:.5em 1em;font-size:1.1em;background-color:wheat}</style><meta name="generator" content="Gatsby 2.32.11"/><title data-react-helmet="true">Merging Maps | max-bittker</title><script data-react-helmet="true" async="" defer="" src="https://www.recurse-scout.com/loader.js?t=3a128824cb3dacb3e5bf25cec6f3b40e"></script><link href="//fonts.googleapis.com/css?family=Montserrat:700|Arvo:400,400i,700" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/webpack-runtime-ebafe418e0df1e4bb1d9.js"/><link as="script" rel="preload" href="/framework-b6211828bac0bb31fab5.js"/><link as="script" rel="preload" href="/app-fcbe65706a73bb6273df.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-4047b62bf1fe23e9fef7.js"/><link as="fetch" rel="preload" href="/page-data/merging-maps/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="b-wrap fill" style="min-height:100vh"><div class="b-wrap fill"><div class="b-wrap fill"><div class="b-wrap fill"><div class="b-wrap fill"><div class="b-wrap fill"><div style="width:100%"><div class="header"><div class="b-wrap pack"><div class="b-wrap"><div class="b-wrap"><div class="b-wrap"><a style="color:black;text-decoration:none;padding:0px  3px;position:relative;z-index:100;text-shadow:-1px -1px  #f4eeef,
   1px -1px  #f4eeef,
   -1px 1px  #f4eeef,
  1px 1px  #f4eeef,
  -2px -2px  #f4eeef,
   2px -2px  #f4eeef,
   -2px 2px  #f4eeef,
  2px 2px  #f4eeef" href="/">max bittker</a></div></div></div></div><div class="b-wrap pack"><div class="b-wrap"><div class="b-wrap"><div class="b-wrap"><a style="color:black;text-decoration:none;padding:0px  3px;position:relative;z-index:100;text-shadow:-1px -1px  #f4eeef,
   1px -1px  #f4eeef,
   -1px 1px  #f4eeef,
  1px 1px  #f4eeef,
  -2px -2px  #f4eeef,
   2px -2px  #f4eeef,
   -2px 2px  #f4eeef,
  2px 2px  #f4eeef" href="/projects/">projects</a></div></div></div></div><div class="b-wrap pack"><div class="b-wrap"><div class="b-wrap"><div class="b-wrap"><a style="color:black;text-decoration:none;padding:0px  3px;position:relative;z-index:100;text-shadow:-1px -1px  #f4eeef,
   1px -1px  #f4eeef,
   -1px 1px  #f4eeef,
  1px 1px  #f4eeef,
  -2px -2px  #f4eeef,
   2px -2px  #f4eeef,
   -2px 2px  #f4eeef,
  2px 2px  #f4eeef" href="/blog/">blog</a></div></div></div></div></div><div style="margin:0 auto;max-width:960px;padding-top:0"><div><h1>Merging Maps</h1><p style="font-size:0.85028rem;line-height:1.65rem;display:block;margin-bottom:1.65rem;margin-top:-1.65rem">October 31, 2017</p><div><blockquote>
<p>“If I were going to give you a quick summary of what our codebase is like, I’d say it’s procedural code that manipulates maps.”</p>
</blockquote>
<p>-<a href="https://blog.skyliner.io/fourteen-months-with-clojure-beb8b3e4bf00"><em>Fourteen Months with Clojure</em></a> by Dan McKinley</p>
<p>Maps or <em>“Associative arrays”</em> are a ubiquitous abstraction in software development. They allow us to model data in a flexible form that lends itself to manipulation, inspection, and portability.</p>
<p>If you’re looking, you’ll see maps everywhere — in databases, file systems, serialization formats, object oriented programming languages, and most likely, all over your codebase.</p>
<p>…Except you may not call them “maps” --- key value data structures inexplicably have a different name in every single programming language:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
  Python: &quot;Dictionary&quot;,
  Javascript: &quot;Object&quot;,
  Lua: &quot;Table&quot;,
  PHP: &quot;Associative Array&quot;,
  Ruby: &quot;Hash&quot;,
  Java: &quot;HashMap&quot;,
  Clojure: &quot;Map&quot;,
  Go: &quot;... also Map.&quot;
}</code></pre></div>
<p>It’s not just the names. I’ve found the tradeoffs and ergonomics provided around maps to be a significant point of asymmetry between languages. The idea behind this post is to compare languages “fluency” in map processing through a common operation: merging multiple maps into one.</p>
<h2>Merging Maps?</h2>
<p>Merge is not a primitive operation on key value data structures in the same way that get, set, or enumeration are. That being said, it’s an elementary algorithm that enables elegant representations of practical tasks like collating data, class inheritance, updating centralized state, and overriding defaults. So - what does it mean to me to have first class support for merging maps? Ideally, I’d like to see a single method that’s:</p>
<p>Composable</p>
<p>: Can you use it as an expression and nest it with other expressions?</p>
<p>Variadic</p>
<p>: Can it merge more than two maps in a single invocation?</p>
<p>Extensible</p>
<p>: Can you customize the value resolution strategy for key collisions?</p>
<p>Preserving</p>
<p>: Does it mutate the original map, or return a new one?</p>
<p>You might read this analysis and feel that it’s meaningless to judge the quality of built-in merge functions, when any sort of merge functionality could be ‘trivially’ implemented, imported, or coaxed out of a slick one-liner.
This is all completely true — but I still hope you’ll find this comparison to be an interesting lens to the priorities and baseline “quality of life” of these languages.</p>
<h3>Javascript:</h3>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> shoulders<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> knees<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> toes<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>composable, variadic, and preserving</strong></p>
<p>Not bad - slightly esoteric invocation ^[Javascript objects’ string keys can be accessed with the dot operator like <code class="language-text">body.shoulder</code>, so to avoid collisions, the standard library methods are only attached to the Object constructor instead of to the instances], but it accepts any number of maps. The return value is the mutated first argument, but to side-step that, you can pass an empty object literal <strong><code class="language-text">{}</code></strong> in the first position.</p>
<p>Accepting multiple arguments doesn’t just save you from typing it’s helpful at runtime as well. The <strong><code class="language-text">...</code></strong> spread operator (or <code class="language-text">apply</code> function) can be used to merge a dynamic number of objects from an array.</p>
<p>No way to customize merge strategies with this function, you’ll need to defer to a helper library, or drop down to a <code class="language-text">reduce</code> one-liner.</p>
<p>Worth mentioning that like everything in javascript, there’s a caveat: This was part of the ECMAScript 2015 standard, and isn’t available in all JS environments. ^[If you need you Object.assign to work across all browsers, you need to polyfill or import a utility library]</p>
<h3>Ruby:</h3>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby">    mapA<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>mapB<span class="token punctuation">)</span>
    <span class="token comment"># with collision resolution block:</span>
    mapA<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>mapB<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">|</span>key<span class="token punctuation">,</span> valA<span class="token punctuation">,</span> valB<span class="token operator">|</span> valA <span class="token operator">+</span> valB<span class="token punctuation">}</span></code></pre></div>
<p><strong>composable, extensible and preserving</strong></p>
<p>There’s also a version <strong><code class="language-text">merge!</code></strong> with the same api that <em>does</em> mutate the array, which is pretty sweet. In order to merge multiple hashes, you can invoke merge with <code class="language-text">inject</code> (aka reduce aka fold) like this:</p>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby">  <span class="token punctuation">[</span>mapA<span class="token punctuation">,</span> mapB<span class="token punctuation">,</span> mapC<span class="token punctuation">]</span><span class="token punctuation">.</span>inject<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token symbol">:merge</span><span class="token punctuation">)</span></code></pre></div>
<h3>Python:</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">  dictD <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">**</span>dictA<span class="token punctuation">,</span> <span class="token operator">**</span>dictB<span class="token punctuation">,</span> <span class="token operator">**</span>dictC<span class="token punctuation">}</span></code></pre></div>
<p><strong>composable, variadic, and preserving</strong></p>
<p>This is quite nice - but only works in python 3.5+, taking advantage of the <strong>`</strong>`** “splat” unpacking operator. This makes it incompatible with situations where you have a <em>list\</em> of dictionaries to merge, because the same splat operator is also used for spreading lists out into function arguments, and to my knowledge you can’t double splat.</p>
<p>You can merge dictionaries in python 2.7 like so:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">    <span class="token builtin">dict</span><span class="token punctuation">(</span>dictA<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> dictB<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>but be warned that <em>this one</em> doesn’t work in python 3.</p>
<h3>PHP:</h3>
<div class="gatsby-highlight" data-language="php"><pre class="language-php"><code class="language-php">    <span class="token variable">$arrayD</span> <span class="token operator">=</span> <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$arrayA</span><span class="token punctuation">,</span> <span class="token variable">$arrayB</span><span class="token punctuation">,</span> <span class="token variable">$arrayC</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>composable, variadic, preserving, and confusing</strong></p>
<p>PHP uses a single data structure for associative and indexed arrays, and so its standard library methods have mixed behavior depending on the type of each key (strings versus numbers). In this case, <code class="language-text">array_merge</code> will overwrite string key collisions with their “rightmost” occurrence, but <em>renumber</em> numeric keys, similar to an array append in other languages. There’s also the union operator <strong><code class="language-text">+</code></strong>:</p>
<div class="gatsby-highlight" data-language="php"><pre class="language-php"><code class="language-php">    <span class="token variable">$arrayC</span> <span class="token operator">=</span> <span class="token variable">$arrayA</span> <span class="token operator">+</span> <span class="token variable">$arrayB</span><span class="token punctuation">;</span></code></pre></div>
<p>which takes the <em>leftmost</em> value in cases of string and numeric key collisions, with no renumbering … or you could use <code class="language-text">array_replace</code>, which takes the <em>rightmost</em> value like <code class="language-text">array_merge</code>, but doesn’t renumber numeric keys.^[Had trouble keeping the PHP merging methods straight? There’s a great picture <a href="https://softonsofa.com/php-array_merge-vs-array_replace-vs-plus-aka-union/">here.</a>]</p>
<p>PHP also includes a functionality in its standard library that none of the other languages here do: <strong>deep</strong> merging. <code class="language-text">array_merge_recursive</code> will recursively call merge on string key collisions. When colliding values aren’t arrays, it wraps them in arrays with the key <code class="language-text">0</code>, which can then be merged — but this means renumbering/concatenating happens instead of ending up with one value or the other. I’ll only touch on one more function- <code class="language-text">array_replace_recursive</code>. It operates under the same idea as its sibling <code class="language-text">array_merge_recursive</code>, allowing you to merge nested arrays, but doesn’t try to coerce and renumbering on collisions, so you won’t find values changing type. ^[There are illustrative examples of array<em>replace</em>recursive vs array<em>merge</em>recursive <a href="https://jontai.me/blog/2011/12/array_merge_recursive-vs-array_replace_recursive/">here:</a>]</p>
<p>The way PHP blurs the line between indexed and associative arrays allows for some interesting merging mechanics, but there are also cognitive costs to having so many subtly different operations.</p>
<h3>Clojure:</h3>
<div class="gatsby-highlight" data-language="clojure"><pre class="language-clojure"><code class="language-clojure">    <span class="token punctuation">(</span><span class="token keyword">merge</span> <span class="token punctuation">{</span><span class="token operator">:a</span> <span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">:a</span> <span class="token number">2</span> <span class="token operator">:b</span> <span class="token number">3</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">:c</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">;;=> {:a 2, :b 3, :c 4}</span>
    <span class="token punctuation">(</span><span class="token keyword">merge-with</span> <span class="token keyword">+</span>
      <span class="token punctuation">{</span><span class="token operator">:a</span> <span class="token number">1</span>  <span class="token operator">:b</span> <span class="token number">2</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token operator">:a</span> <span class="token number">9</span>  <span class="token operator">:b</span> <span class="token number">98</span> <span class="token operator">:c</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">;;=> {:a 10, :b 100, :c 0}</span>
    <span class="token punctuation">(</span><span class="token keyword">merge-with</span> <span class="token keyword">vector</span>
      <span class="token punctuation">{</span><span class="token operator">:a</span> <span class="token number">1</span>  <span class="token operator">:b</span> <span class="token number">2</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token operator">:a</span> <span class="token number">9</span>  <span class="token operator">:b</span> <span class="token number">98</span> <span class="token operator">:c</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">;;=>{:a [1 9], :b [2 98], :c 0}</span></code></pre></div>
<p><strong>composable, variadic, extensible, and preserving</strong></p>
<p>Everything in clojure is an expression and so everything is composable - there <em>are</em> no statements. Map literals are often used as an argument syntax for functions with optional named arguments, and merge is a convenient way to override a map of defaults with a map of arguments.</p>
<p>Clojure functions tend to accept many arguments whenever possible, and there are a host of nice patterns like spreading, applying and destructuring to take full advantage of these variadic functions. It’s a language where it’s idiomatic to add a list of numbers by shoving them all into to a single <strong><code class="language-text">+</code></strong> expression.</p>
<p><code class="language-text">merge-with</code> accepts a strategy for resolution, similar to ruby’s. The difference is that ruby’s block provides three arguments (key, valueA, valueB), where clojure has a simpler signature - just the values. This is actually a boon in many situations, because it means that you can skip writing an anonymous function and make direct use of existing functions, like <strong><code class="language-text">+</code></strong> and <strong><code class="language-text">vector</code></strong> in the example.</p>
<p>There’s one more hidden bonus here - clojure’s maps are backed by an immutable data structure that lets us non-destructively build a new map in less than linear time and memory, by internally pointing to old values where possible. This means otherwise expensive merges can be very cheap!</p>
<h3>Java:</h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">    mapA<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>mapB<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>None of the above.</strong>
Because this function is a side effect with no return value, it can’t even be composed with other expressions. However, Java ecosystem leverages interfaces extensively and so it’s common to use other implementations of <strong><code class="language-text">Map&lt;K,V&gt;</code></strong>, such as Guava’s <code class="language-text">ImmutableMap</code>. This allows you to take advantage of nicer semantics while (theoretically) interoperating with other functions that expect maps.</p>
<h3>Go:</h3>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go">    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> b <span class="token punctuation">{</span>
        a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v
    <span class="token punctuation">}</span></code></pre></div>
<h3>Lua:</h3>
<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua">    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>tableB<span class="token punctuation">)</span> <span class="token keyword">do</span>
      tableA<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
    <span class="token keyword">end</span></code></pre></div>
<p>Go and Lua have no standard library implementations for merging their maps. Writing things out imperatively gets the job done and doesn’t hide any details, but the simplicity of these languages means you give up conveniences like high level map operations. ^[Most big Go or Lua projects end up pulling in dependencies like <a href="https://github.com/imdario/mergo">mergo</a> or <a href="https://stevedonovan.github.io/Penlight/api/libraries/pl.tablex.html#Merging">penlight tablex</a>]</p>
<h3>C:</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    ¯\_(ツ)_/¯</code></pre></div>
<p>In C, there’s not even a built-in concept of a map. Either make do with arrays and the fixed-layout struct, import a library, or write your own tree/hash algorithm implementation.</p>
<h3>Thanks for Reading!</h3>
<p>Hopefully you think this rosetta code style tour has been a worthwhile point of comparison. I’m not proficient in all of the languages that I touched on, and while I learned a lot researching this post, it’s far from balanced or perfect. If you feel that your favorite language’s honor has been irreparably damaged by my ignorance, I’d be interested to hear.</p></div><hr style="margin-bottom:1.65rem"/><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/first-order-retrievability/">← <!-- -->First Order Retrievability with Hammerspoon</a></li><li><a rel="next" href="/user-styles/">Make Yourself Comfortable with Custom Styling<!-- --> →</a></li></ul></div></div></div></div></div></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/merging-maps";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-8d4b75a2d1f40b917928.js"],"app":["/app-fcbe65706a73bb6273df.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2bff5a6ff1b78f60e695.js"],"component---src-pages-art-js":["/component---src-pages-art-js-fcd91153e2ffe8e454be.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-f437a17d44519764490b.js"],"component---src-pages-face-js":["/component---src-pages-face-js-c06572c49e1a2a5ed869.js"],"component---src-pages-index-js":["/component---src-pages-index-js-14ac085804f81be41f19.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-b88bd71d0741e1dbf6c4.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-4047b62bf1fe23e9fef7.js"]};/*]]>*/</script><script src="/polyfill-8d4b75a2d1f40b917928.js" nomodule=""></script><script src="/component---src-templates-blog-template-js-4047b62bf1fe23e9fef7.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-fcbe65706a73bb6273df.js" async=""></script><script src="/framework-b6211828bac0bb31fab5.js" async=""></script><script src="/webpack-runtime-ebafe418e0df1e4bb1d9.js" async=""></script></body></html>